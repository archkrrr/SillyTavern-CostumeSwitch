<div id="costume-switcher-settings" class="extension_container">
  <div class="inline-drawer">
    <div class="inline-drawer-toggle inline-drawer-header">
      <b>Dynamic Character Expressions</b>
      <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
    </div>
    <div class="inline-drawer-content">
      
      <div class="tracker-block">
        <input id="cs-enable" type="checkbox" />
        <label for="cs-enable">Enable Costume Switch</label>
        <small>
          Enables or disables the costume-switching functionality. When checked, the extension will listen for character names and automatically switch costumes.
        </small>
      </div>

      <div class="tracker-block">
        <label for="cs-patterns">Character Patterns</label><br />
        <textarea id="cs-patterns" class="text_pole" rows="2" placeholder="Char A, Char B, Char C, Char D"></textarea>
        <small>
          Enter the character names the extension should listen for, one per line. You can use simple names (e.g., `Char A`) or advanced regular expressions (e.g., `/Char A|Char B/`).
        </small>
      </div>

      <div class="tracker-block">
        <label for="cs-default">Default Costume</label><br />
        <input id="cs-default" class="text_pole" type="text" placeholder="Enter default costume..." />
        <small>
          The costume to use when no character is detected. If you leave this blank, it will use the character's main avatar.
        </small>
      </div>

      <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
          <b>Detection Methods</b>
          <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
          <small>Configure how the extension detects characters for different writing styles. Checking more boxes enables more flexible "Novel Style" detection.</small>
          <br><br>
          <small><b>For Script Style (`Name: "Dialogue"`)</b>: Uncheck all boxes below. The extension will only switch when it sees a name followed by a colon.</small>
          
          <table style="width: 100%; margin-top: 10px; border-spacing: 0 12px; border-collapse: separate;">
            <tbody>
              <tr>
                <td style="width: 35%; vertical-align: top;">
                  <input id="cs-detect-attribution" type="checkbox" />
                  <label for="cs-detect-attribution"><b>Detect Attribution</b></label>
                </td>
                <td>
                  <small>Looks for phrases like <em>"I agree," Char A said.</em> This is a high-priority hint that tells the engine who is currently speaking.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-action" type="checkbox" />
                  <label for="cs-detect-action"><b>Detect Action</b></label>
                </td>
                <td>
                  <small>Looks for a name followed by an action, like <em>Char B leaned forward.</em> This helps identify the character performing an action, making them the scene's focus.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-vocative" type="checkbox" />
                  <label for="cs-detect-vocative"><b>Detect Vocative</b></label>
                </td>
                <td>
                  <small>Looks for characters being addressed, like <em>"What do you think, Char A?"</em> This tells the engine who is being spoken to, which helps it infer who will speak next.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-possessive" type="checkbox" />
                  <label for="cs-detect-possessive"><b>Detect Possessive</b></label>
                </td>
                <td>
                  <small>Looks for ownership, like <em>Char A's sword glowed.</em> This is a lower-priority hint and is less likely to cause a switch on its own.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-general" type="checkbox" />
                  <label for="cs-detect-general"><b>Detect General Mentions</b></label>
                </td>
                <td>
                  <small>The least accurate method. It will trigger on any mention of a character's name. <b>Warning:</b> The context engine is good at ignoring these, but it can still cause incorrect switches.</small>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
          <b>Cooldowns & Timeouts</b>
          <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
          <div class="tracker-block inline-group">
            <label for="cs-timeout">Costume Reset Timeout</label><br />
            <input id="cs-timeout" class="text_pole" type="number" min="0" />
            <small>
              Set the time (in milliseconds) before resetting to the default costume if no character is detected. Set to 0 to disable.
            </small>
          </div>
    
          <div class="tracker-block inline-group">
            <label for="cs-global-cooldown">Global Cooldown</label><br />
            <input id="cs-global-cooldown" class="text_pole" type="number" min="0" />
            <small>
              The minimum time (in milliseconds) between any two costume switches to prevent flickering.
            </small>
          </div>
    
          <div class="tracker-block inline-group">
            <label for="cs-repeat-suppress">Repeat Suppression</label><br />
            <input id="cs-repeat-suppress" class="text_pole" type="number" min="0" />
            <small>
              The minimum time (in milliseconds) before the same character can trigger another switch.
            </small>
          </div>
        </div>
      </div>

      <div class="tracker-block">
        <label for="cs-mappings">Costume Mappings</label><br />
        <table id="cs-mappings" class="text_pole">
          <thead>
            <tr>
              <th>Character Name</th>
              <th>Costume Folder</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="cs-mappings-tbody">
            </tbody>
        </table>
        <button id="cs-mapping-add" class="menu_button fa-solid fa-file-circle-plus interactable">Add Mapping</button>
        <small>
          Map a detected character name to a specific costume folder. Useful if your folder names don't match the character names exactly.
        </small>
      </div>

      <div class="tracker-block">
        <input id="cs-debug" type="checkbox" />
        <label for="cs-debug">Enable Debug Logging</label>
        <small>
          Logs detailed information to the browser console (F12) for troubleshooting.
        </small>
      </div>

      <div class="tracker-block flex-container">
        <button id="cs-save" class="menu_button fa-solid fa-save interactable">Save Settings</button>
        <button id="cs-reset" class="menu_button fa-solid fa-undo interactable">Manual Reset</button>
      </div>

      <div id="cs-status" class="status-message">Ready</div>
      <div id="cs-error" class="error-message"></div>
    </div>
  </div>
</div>
