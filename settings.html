<div id="costume-switcher-settings" class="extension_container">
  <div class="inline-drawer">
    <div class="inline-drawer-toggle inline-drawer-header">
      <b>Costume Switch Settings</b>
      <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
    </div>
    <div class="inline-drawer-content">
      
      <div class="tracker-block">
        <input id="cs-enable" type="checkbox" />
        <label for="cs-enable">Enable Costume Switch</label>
        <small>
          Enables or disables the costume-switching functionality. When checked, the extension will listen for specific character names in the AI’s responses and automatically switch costumes based on those names. If unchecked, the feature is disabled, and no costume switching will occur.
        </small>
      </div>

      <div class="tracker-block">
        <label for="cs-patterns">Character Patterns</label><br />
        <textarea id="cs-patterns" class="text_pole" rows="2" placeholder="Char A, Char B, Char C, Char D"></textarea>
        <small>
          Enter the character names here. The extension will listen for these names in the AI’s messages. When a match is detected, the extension triggers a costume change. Each name should be entered on a new line.
        </small>
      </div>

      <div class="tracker-block">
        <label for="cs-default">Default Costume</label><br />
        <input id="cs-default" class="text_pole" type="text" placeholder="Enter default costume..." />
        <small>
          This input field defines the default costume. If no character name is detected in the stream (or if the detection fails), the extension will revert to this default costume after the specified timeout. You must click save whenever this is changed.
        </small>
      </div>

      <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
          <b>Detection Methods</b>
          <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
          <small>Enable or disable specific detection methods. Disabling methods can improve accuracy if you only want to switch on specific cues. Speaker tags (e.g., `Name:`) are always enabled. <b>To detect *only* speaker tags, uncheck all the boxes below.</b></small>
          
          <table style="width: 100%; margin-top: 10px; border-spacing: 0 12px; border-collapse: separate;">
            <tbody>
              <tr>
                <td style="width: 35%; vertical-align: top;">
                  <input id="cs-detect-attribution" type="checkbox" />
                  <label for="cs-detect-attribution"><b>Detect Attribution</b></label>
                </td>
                <td>
                  <small>Looks for phrases where a character is credited with speaking, like <em>"I agree," Tohka said.</em> This is a high-priority, accurate method.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-action" type="checkbox" />
                  <label for="cs-detect-action"><b>Detect Action</b></label>
                </td>
                <td>
                  <small>Looks for a character's name followed by an action verb, like <em>Kotori leaned forward.</em> This is useful for identifying the character performing an action.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-vocative" type="checkbox" />
                  <label for="cs-detect-vocative"><b>Detect Vocative</b></label>
                </td>
                <td>
                  <small>Looks for instances where a character is being directly addressed, like <em>"What do you think, Shido?"</em> This is useful for scenes with direct dialogue.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-possessive" type="checkbox" />
                  <label for="cs-detect-possessive"><b>Detect Possessive</b></label>
                </td>
                <td>
                  <small>Looks for a character's name showing ownership, like <em>Tohka's sword glowed.</em> This is a lower-priority match.</small>
                </td>
              </tr>
              <tr>
                <td style="vertical-align: top;">
                  <input id="cs-detect-general" type="checkbox" />
                  <label for="cs-detect-general"><b>Detect General Mentions</b></label>
                </td>
                <td>
                  <small>The least accurate method. It will trigger on any mention of a character's name that doesn't fit the other categories. <b>Warning:</b> This can cause incorrect switches if a character is mentioned by someone else.</small>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
          <b>Cooldowns & Timeouts</b>
          <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
          <div class="tracker-block inline-group">
            <label for="cs-timeout">Costume Reset Timeout</label><br />
            <input id="cs-timeout" class="text_pole" type="number" min="0" />
            <small>
              Set the timeout (in milliseconds) before resetting to the default costume. Default is 5 minutes (300000ms).
            </small>
          </div>
    
          <div class="tracker-block inline-group">
            <label for="cs-global-cooldown">Global Cooldown</label><br />
            <input id="cs-global-cooldown" class="text_pole" type="number" min="0" />
            <small>
              Cooldown (in milliseconds) between any two switches to prevent flickering.
            </small>
          </div>
    
          <div class="tracker-block inline-group">
            <label for="cs-repeat-suppress">Repeat Suppression</label><br />
            <input id="cs-repeat-suppress" class="text_pole" type="number" min="0" />
            <small>
              Cooldown (in milliseconds) before the same character can be triggered again.
            </small>
          </div>
        </div>
      </div>

      <div class="tracker-block">
        <label for="cs-mappings">Costume Mappings</label><br />
        <table id="cs-mappings" class="text_pole">
          <thead>
            <tr>
              <th>Character Name</th>
              <th>Costume Folder</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="cs-mappings-tbody">
            </tbody>
        </table>
        <button id="cs-mapping-add" class="menu_button fa-solid fa-file-circle-plus interactable">Add Mapping</button>
        <small>
          Map character names to specific costume folders here. When a character name is detected, the extension will switch to the mapped costume folder.
        </small>
      </div>

      <div class="tracker-block">
        <input id="cs-debug" type="checkbox" />
        <label for="cs-debug">Enable Debug Logging</label>
        <small>
          Logs detailed information to the browser console for troubleshooting.
        </small>
      </div>

      <div class="tracker-block flex-container">
        <button id="cs-save" class="menu_button fa-solid fa-save interactable">Save Settings</button>
        <button id="cs-reset" class="menu_button fa-solid fa-undo interactable">Manual Reset</button>
      </div>

      <div id="cs-status" class="status-message">Ready</div>
      <div id="cs-error" class="error-message"></div>
    </div>
  </div>
</div>
