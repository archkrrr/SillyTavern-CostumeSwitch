<div id="costume-switcher-settings" class="extension_container">
  <div class="inline-drawer">
    <div class="inline-drawer-toggle inline-drawer-header">
      <b>Costume Switch Settings</b>
      <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
    </div>
    <div class="inline-drawer-content">
      
      <!-- Enable Costume Switch -->
      <div class="tracker-block">
        <input id="cs-enable" type="checkbox" />
        <label for="cs-enable">Enable Costume Switch</label>
        <small>
          Enables or disables the costume-switching functionality. When checked, the extension will listen for specific character names in the AI’s responses and automatically switch costumes based on those names. If unchecked, the feature is disabled, and no costume switching will occur.
        </small>
      </div>

      <!-- Character Patterns -->
      <div class="tracker-block">
        <label for="cs-patterns">Character Patterns</label><br />
        <textarea id="cs-patterns" class="text_pole" rows="2" placeholder="Shido, Kotori, Tohka, Reine"></textarea>
        <small>
          Enter the character names here. The extension will listen for these names in the AI’s messages. When a match is detected, the extension triggers a costume change. Each name should be entered on a new line.
        </small>
      </div>

      <!-- Default Costume -->
      <div class="tracker-block">
        <label for="cs-default">Default Costume</label><br />
        <input id="cs-default" class="text_pole" type="text" placeholder="Enter default costume..." />
        <small>
          This input field defines the default costume. If no character name is detected in the stream (or if the detection fails), the extension will revert to this default costume after the specified timeout.
        </small>
      </div>

      <!-- Costume Reset Timeout -->
      <div class="tracker-block inline-group">
        <label for="cs-timeout">Costume Reset Timeout</label><br />
        <input id="cs-timeout" class="text_pole" type="number" min="0" value="300000" />
        <small>
          Set the timeout (in milliseconds) before resetting the costume back to the default costume if no new character names are detected. The default value is set to 5 minutes (300000ms).
        </small>
      </div>

      <!-- Global Cooldown -->
      <div class="tracker-block inline-group">
        <label for="cs-global-cooldown">Global Cooldown</label><br />
        <input id="cs-global-cooldown" class="text_pole" type="number" min="0" value="700" />
        <small>
          This value defines the global cooldown period (in milliseconds) between costume switches. It helps prevent flickering by ensuring there is a delay between consecutive costume switches.
        </small>
      </div>

      <!-- Repeat Suppression -->
      <div class="tracker-block inline-group">
        <label for="cs-repeat-suppress">Repeat Suppression</label><br />
        <input id="cs-repeat-suppress" class="text_pole" type="number" min="0" value="800" />
        <small>
          This sets a suppression period (in milliseconds) for repeated costume switches. If the same character name appears again within this time, no costume change will occur.
        </small>
      </div>

      <!-- Costume Mappings -->
      <div class="tracker-block">
        <label for="cs-mappings">Costume Mappings</label><br />
        <table id="cs-mappings" class="text_pole">
          <thead>
            <tr>
              <th>Character Name</th>
              <th>Costume Folder</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="cs-mappings-tbody">
            <!-- Mappings will be dynamically inserted here -->
          </tbody>
        </table>
        <button id="cs-mapping-add" class="menu_button fa-solid fa-file-circle-plus interactable">Add Mapping</button>
        <small>
          Map character names to specific costume folders here. When a character name is detected in the AI’s messages, the extension will switch to the mapped costume folder. Use the "Add Mapping" button to add more mappings.
        </small>
      </div>

      <!-- Enable Debug Logging -->
      <div class="tracker-block">
        <input id="cs-debug" type="checkbox" />
        <label for="cs-debug">Enable Debug Logging</label>
        <small>
          When enabled, debug logging will be activated. This allows the extension to log detailed information about the costume-switching process, which can help with troubleshooting.
        </small>
      </div>

      <!-- Save Settings Button -->
      <div class="tracker-block flex-container">
        <button id="cs-save" class="menu_button fa-solid fa-save interactable">Save Settings</button>
        <small>
          Click this button to save your changes to the settings. The changes will take effect immediately after saving.
        </small>
      </div>

      <!-- Manual Reset Button -->
      <div class="tracker-block flex-container">
        <button id="cs-reset" class="menu_button fa-solid fa-undo interactable">Manual Reset</button>
        <small>
          Click this button to manually reset the costume to the default, even if a character is detected in the stream. This will immediately revert to the default costume.
        </small>
      </div>

      <!-- Status and Error Messages -->
      <div id="cs-status" class="status-message">Ready</div>
      <div id="cs-error" class="error-message"></div>
    </div>
  </div>
</div>

<style>
  /* Maintain extension container's theme */
  .extension_container {
    font-family: Arial, sans-serif;
    background-color: #333;
    color: #fff;
    padding: 10px;
    border-radius: 8px;
    width: 100%;
  }

  .inline-drawer-header {
    font-size: 1.2em;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .inline-drawer-content {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .tracker-block {
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .tracker-block.inline-group {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .text_pole {
    background-color: #444;
    color: white;
    border: 1px solid #555;
    border-radius: 4px;
    padding: 6px;
    font-size: 0.9em;
    box-sizing: border-box;
    width: 100%;
  }

  /* Table Styling for Mappings Section */
  #cs-mappings {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }

  #cs-mappings th, #cs-mappings td {
    padding: 8px;
    text-align: left;
    border-bottom: 1px solid #555;
  }

  button.menu_button {
    background-color: #666;
    color: white;
    border-radius: 5px;
    padding: 6px 12px;
    cursor: pointer;
  }

  button.menu_button:hover {
    background-color: #888;
  }

  hr.sysHR {
    border: none;
    height: 1px;
    background-color: #555;
    margin: 10px 0;
  }

  .status-message {
    padding: 8px;
    background-color: #4CAF50;
    border-radius: 5px;
    margin-top: 8px;
  }

  .error-message {
    padding: 8px;
    background-color: #F44336;
    border-radius: 5px;
    margin-top: 8px;
  }

  .tracker-block label {
    font-size: 0.9em;
    margin-bottom: 5px;
  }

  /* Compact styling for input fields and textareas */
  .text_pole, button.menu_button, select {
    font-size: 0.85em;
  }

  /* Make sure the form elements and buttons are compact */
  .tracker-block textarea {
    font-size: 0.85em;
    resize: vertical;
  }
</style>
